# T1 原神

**时间限制：** 1.0 秒 

**空间限制：** 512 MiB




## 题目背景

“你在学校不能玩游戏，在家也不能”

ExZx 是著名的信息学教练，他在一所优美的学校任职。

ExZx 有很多个学生，每个学生的设备都被 ExZx 的监视器监视着。

秉持着“日新博学，志航天下”的校训，ExZx 对学生们有着严格的要求，他禁止学生们玩原神。

为了防止学生们玩原神， ExZx 会随机监视学生们的设备。



## 题目描述

ExZx 喜欢“中位数”。在本题中，一个序列长度为 $n$ 的序列的中位数被定义为序列第 $\lceil\frac n2\rceil$ **大**的数。例如：

- $[1,1,4,5,1,4]$ 的中位数为 $4$。
- $[19,1,9,8,10]$ 的中位数为 $9$。

类似地，ExZx 定义一个长度为 $n$ 的序列 $a$ 的“$k$ 等分数”为 $a$ 的第 $\lceil\frac nk\rceil$ **大**的数。

每个学生有一个 O 值，这个值越大学生越喜欢玩原神。

现在监视器出现了一些故障，导致 ExZx 只能选择学生的一个区间 $[l,r]$，区间需满足 $r-l+1\ge L$，并查询 $[l,r]$ 中 O 值为区间内“$k$ 等分数”的学生有没有在玩原神。

当然，明察秋毫的 ExZx 知道每个学生的 O 值。为了使抓到玩原神的学生的概率尽可能高，ExZx 需要选择一个区间，使得区间内 O 值的 “$k$ 等分数”最大。

你需要替他完成这个认为，输出“ $k$ 等分数”的最大值。



## 输入格式

第一行三个正整数 $n,k,L$。

第二行 $n$ 个正整数表示序列 $a$，表示学生的 O 值。



## 输出格式

一行一个正整数表示答案。




## 样例1输入

```plain
10 3 5
1 3 2 4 3 2 3 4 3 3
```



## 样例1输出

```plain
4
```



## 样例1解释

选择第 $4$ 到第 $8$ 个学生，$3$ 等分数为 $4$。



## 数据范围

对于 $20\%$ 的数据，$n\le300$。

对于 $40\%$ 的数据，$n\le1000$。

对于另外 $10\%$ 的数据，$L=1$。

对于另外 $20\%$ 的数据，$k=2$。

对于 $100\%$ 的数据，$1\le a_i,l\le n\le10^6,2\le k\le n$。

<div style="page-break-after:always"></div>

# T2 竹溪数

**时间限制：** 2.0 秒 

**空间限制：** 512 MiB




## 题目背景

“动态规划常考而 dp 不常考”

动态规划和 dp 是什么呢，ExZx 不想研究。

ExZx 喜欢数学，他近期在挑战哥德巴赫猜想。

ExZx 首先证明了，如果把时间拓展到一个复平面，那么期望在 $(114514+1919810i)$ 年后就能证明哥德巴赫猜想。



## 题目描述

在哥猜证明过程中，ExZx 在证明过程中遇到了一个难题：竹溪数。

我们定义 $s$ 阶竹溪数：如果一个数十进制下的高位到低位分别是 $p_1,p_2,\cdots,p_n \  \ (p_1\ne 0)$，并且 $p$ 的最长**严格下降**子序列的长度为 $s$，那么这个数就是 $s$  阶竹溪数。

在哥猜证明的第 $998244353$ 步中需要求出 $1\sim n$ 中所有 $s$ 阶竹溪树的 $k$ 次方和。ExZx 认为这个问题太简单了，于是他将这个问题给了你。

你需要将答案告诉 ExZx。答案可以很大，你需要输出其对 $998244353$ 取模的结果。



## 输入格式

第一行两个整数 $s,k$。

第二行一个正整数 $n$。



## 输出格式

一行一个整数表示答案。




## 样例1输入

```plain
3 1
432
```



## 样例1输出

```plain
1605
```



## 样例1解释

$3$ 阶竹溪数共 $4$ 个：$321,421,431,432$，一次方之和为 $1605$。



## 数据范围

对于 $10\%$ 的数据，$n\le 10^3$。

对于 $20\%$ 的数据，$n\le 10^6$。

对于 $30\%$ 的数据，$n\le 10^7$。

对于另外 $10\%$ 的数据，$s=1$。

对于另外 $10\%$ 的数据，$k=0$。

对于另外 $10\%$ 的数据，$k=1$。

对于另外 $10\%$ 的数据，$k=2$。

对于 $100\%$ 的数据，$1\le n\le 10^{100}$，输入中 $n$ 不含前导零，$1\le s\le 10,0\le k\le 10$。

<div style="page-break-after:always"></div>

# T3 TwoTrees

**时间限制：** 2.0 秒 

**空间限制：** 512 MiB




## 题目背景

ExZx 的祖先还在树上时就发现了一个规律：

在两颗不同的树上，从两组对应的点出发，有可能走到一个对应的点上。

ExZx 感受到了轩辕召唤，他决定解决这个问题。



## 题目描述

ExZx 给了你两棵有根树 $F,G$，都有 $n$ 个节点，根节点都为 $1$。

如果点对 $(u,v)$ 满足在 $F,G$ 上的 $\operatorname{lca}$ 编号相同，则称 $(u,v)$ 是“好的”。

计算有多少“好的”点对。

**注意，伟大的 ExZx 认为 $(u,v)$ 和 $(v,u)$ 是不同的，$(u,u)$ 也是“好的”点对。**



## 输入格式

第一行一个正整数 $n$。

接下来 $n-1$ 行，每行两个正整数 $(u,v)$ 表示 $F$ 的一条边。

接下来 $n-1$ 行，每行两个正整数 $(u,v)$ 表示 $G$ 的一条边。



## 输出格式

一行一个整数表示答案。




## 样例1输入

```plain
5
2 4
3 4
1 5
1 4
1 4
2 5
3 4
2 4
```



## 样例1输出

```plain
19
```



## 数据范围

对于 $10\%$ 的数据，$n\le 1000$。

对于 $20\%$ 的数据，$n\le 5000$。

对于另外 $20\%$ 的数据，$F$ 的第 $i$ 条边为 $(i,i+1)$。

对于 $100\%$ 的数据，$n\le 5\times10^5$。

<div style="page-break-after:always"></div>

# T4 美食

**时间限制：** 2.0 秒 

**空间限制：** 512 MiB




## 题目背景

THUWC2025，北京。

ExZx，czq，yyhhpp 上了电梯，电梯提示超重。

“你们两个谁这么重？”

czq 是传奇大师，肯定不会超重，那只能是好吃懒做的 yyhhpp 了。



## 题目描述

到底是谁超重了呢，这不重要，重要的是 ExZx 要去品尝美食了。

ExZx 生活在一个城市中，这个城市有 $n$ 个小镇，有 $m$ 条双向道路，保证任意两个城市直接或间接联通。每条道路有一个 值 $w_i$，表示限重 $w_i$。

每个小镇有一种特色美食，其美味值为 $a_i$。ExZx 有一个愉悦值 $y$，如果在第 $i$ 个小镇品尝了特色美食，那么他的愉悦值会变为 $y\operatorname{xor}a_i$。

ExZx 安排了接下来 $q$ 天的行程。每一天，ExZx 会空降到小镇 $x$，此时他的体重为 $W$，初始的愉悦值为 $y$。

他可以在小镇之间游走，但是不能经过限重小于 $W$ 的道路。每到一个小镇，他可以品尝特色美食。并且他可以经过每条道路和每个小镇任意多次。

ExZx 当然想让最后的愉悦值最大啦，但是为了不让自己太放纵，他会问你所有可能的最终愉悦值中的第 $k$ 大。

**注意，第 $k$ 大是指去重之后的第 $k$ 大**。



## 输入格式

第一行一个整数 $c$，表示测试点编号。样例的测试点编号为 $c$。

第一行三个整数 $n,m,q$。

接下来一行 $n$ 个整数，第 $i$ 个数表示 $a_i$。

接下来 $m$ 行，每行三个整数 $u,v,w$，表示在小镇 $u$ 和小镇 $v$ 之间有一条限重为 $w$ 的道路。

接下来 $q$ 行，每行四个整数 $x,W,y,k$，含义见题目描述。



## 输出格式

$q$ 行，每行一个正整数表示答案。




## 样例1输入

```plain
// to do
```



## 样例1输出

```plain
// to do
```



## 数据范围

| 测试点编号 | $1\le n,m,q\le$ | 特殊性质 |
| ---------- | --------------- | -------- |
| 1          | $20$            | ABC      |
| 2          | $20$            | A        |
| 3          | $20$            | 无       |
| 4          | $1000$          | ABC      |
| 5          | $1000$          | AB       |
| 6          | $1000$          | AC       |
| 7          | $1000$          | A        |
| 8          | $1000$          | 无       |
| 9          | $10^5$          | ABCD     |
| 10         | $10^5$          | AD       |
| 11         | $10^5$          | D        |
| 12         | $10^5$          | DE       |
| 13         | $10^5$          | E        |
| 14         | $10^5$          | F        |
| 15         | $10^6$          | ABCDE    |
| 16         | $10^6$          | ADE      |
| 17         | $10^6$          | ADF      |
| 18         | $10^6$          | A        |
| 19         | $10^6$          | 无       |
| 20         | $10^6$          | 无       |

特殊性质 A：$k=1$。

特殊性质 B：$x=1$。

特殊性质 C：$y=0$。

特殊性质 D：每次询问的 $W$ 相同。

特殊性质 E：$m=n-1$，且第 $i$ 条边为 $(i,i+1)$。

特殊性质 F：$m=n-1$，且第 $i$ 条边为 $(1,i+1)$。
